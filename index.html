<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quantis (QTX) Launch</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <img src="qtx-logo.png" alt="QTX Logo" class="logo" />
    <h1>Quantis (QTX) Token Launch</h1>
    <p>Deploy QTX on Solana Mainnet</p>
    <button id="connectWallet">Connect Phantom Wallet</button>
    <button id="deployToken" disabled>Deploy QTX Token</button>
    <div id="status" class="status">Status: Waiting for wallet connection...</div>
  </div>

  <!-- ✅ LIVE FUNCTIONAL SCRIPT -->
  <script type="module">
    import {
      Connection,
      clusterApiUrl,
      PublicKey,
      Keypair,
      sendAndConfirmTransaction
    } from "https://cdn.jsdelivr.net/npm/@solana/web3.js@1.73.3/lib/index.iife.js";

    import {
      createMint,
      getOrCreateAssociatedTokenAccount,
      mintTo
    } from "https://cdn.jsdelivr.net/npm/@solana/spl-token@0.3.5/lib/index.iife.min.js";

    const connectButton = document.getElementById("connectWallet");
    const deployButton = document.getElementById("deployToken");
    const statusDiv = document.getElementById("status");

    let provider = null;
    let wallet = null;

    const FOUNDER_ADDRESS = "CkvoeLNXgeGF99MbUu3YvUd19s5o94iG2Y77QdFitxUC";
    const TOTAL_SUPPLY = 1_000_000_000 * 10 ** 9; // 1B tokens, 9 decimals

    window.addEventListener("DOMContentLoaded", async () => {
      if (window.solana && window.solana.isPhantom) {
        provider = window.solana;

        connectButton.addEventListener("click", async () => {
          try {
            const resp = await provider.connect();
            wallet = resp.publicKey.toString();
            connectButton.innerText = "Connected: " + wallet.slice(0, 6) + "...";
            connectButton.disabled = true;
            deployButton.disabled = false;
            log("✅ Wallet connected: " + wallet);
          } catch (err) {
            log("❌ Wallet connection failed: " + err.message);
          }
        });

        deployButton.addEventListener("click", async () => {
          try {
            const connection = new Connection(clusterApiUrl("mainnet-beta"), "confirmed");

            const mint = await createMint(
              connection,
              provider, // payer
              provider.publicKey, // mint authority
              null, // freeze authority
              9 // decimals
            );

            const founderTokenAccount = await getOrCreateAssociatedTokenAccount(
              connection,
              provider,
              mint,
              new PublicKey(FOUNDER_ADDRESS)
            );

            await mintTo(
              connection,
              provider,
              mint,
              founderTokenAccount.address,
              provider.publicKey,
              TOTAL_SUPPLY
            );

            log(`✅ QTX Token Deployed!\nMint Address: ${mint.toString()}`);
          } catch (err) {
            log("❌ Deployment failed: " + err.message);
            console.error(err);
          }
        });
      } else {
        log("❌ Phantom Wallet not detected. Please install Phantom.");
      }
    });

    function log(message) {
      statusDiv.innerText = message;
    }
  </script>
</body>
</html>
